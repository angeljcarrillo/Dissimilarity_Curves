clear all
close all;
clc
  
a=[-368.580200000000,23.8609000000000;-368.580200000000,25.5460000000000;-368.580200000000,27.2310000000000;-368.580200000000,28.9161000000000;-368.580200000000,30.6012000000000;-368.580200000000,32.2862000000000;-368.580200000000,33.9713000000000;-368.580200000000,35.6563000000000;-368.580200000000,37.3414000000000;-368.580200000000,39.0265000000000];
b=[-365.359000000000,97.7802000000000;-366.043900000000,94.6522000000000;-366.610100000000,91.7598000000000;-367.060800000000,89.0830000000000;-367.398800000000,86.6022000000000;-367.627000000000,84.2974000000000;-367.748200000000,82.1489000000000;-367.766000000000,80.1377000000000;-367.690900000000,78.2591000000000;-367.539600000000,76.5190000000000;-367.328600000000,74.9236000000000;-367.074500000000,73.4793000000000;-366.793800000000,72.1923000000000;-366.503200000000,71.0688000000000;-366.214200000000,70.1002000000000;-365.642100000000,68.4565000000000;-365.071600000000,66.8971000000000;-364.784700000000,66.0338000000000;-364.497000000000,65.0575000000000;-364.220100000000,63.9572000000000;-363.970300000000,62.7358000000000;-363.764400000000,61.3963000000000;-363.618700000000,59.9417000000000;-363.549900000000,58.3749000000000;-363.573800000000,56.6996000000000;-363.851500000000,53.2003000000000;-364.037600000000,51.5264000000000;-364.208900000000,50.0050000000000;-364.330800000000,48.7124000000000;-364.368500000000,47.7252000000000];
c=[-378.194700000000,121.414300000000;-378.879500000000,118.286300000000;-379.445800000000,115.393900000000;-379.896500000000,112.717200000000;-380.234500000000,110.236300000000;-380.462600000000,107.931500000000;-380.583900000000,105.783000000000;-380.601600000000,103.771800000000;-380.526600000000,101.893200000000;-380.375300000000,100.153100000000;-380.164300000000,98.5578000000000;-379.910200000000,97.1135000000000;-379.629500000000,95.8264000000000;-379.338900000000,94.7029000000000;-379.049900000000,93.7343000000000;-378.477800000000,92.0906000000000;-377.907300000000,90.5312000000000;-377.620400000000,89.6679000000000;-377.332700000000,88.6916000000000;-377.055700000000,87.5913000000000;-376.806000000000,86.3699000000000;-376.600100000000,85.0304000000000;-376.454400000000,83.5758000000000;-376.385600000000,82.0090000000000;-376.409500000000,80.3337000000000;-376.687200000000,76.8344000000000;-376.873300000000,75.1605000000000;-377.044600000000,73.6391000000000;-377.166500000000,72.3466000000000;-377.888900000000,68.2314000000000;-378.455200000000,65.3390000000000;-378.905900000000,62.6622000000000;-379.243900000000,60.1814000000000;-379.472100000000,57.8766000000000;-379.593300000000,55.7281000000000;-379.611000000000,53.7169000000000;-379.536000000000,51.8383000000000;-379.384700000000,50.0982000000000;-379.173700000000,48.5028000000000;-378.919600000000,47.0585000000000;-378.638900000000,45.7715000000000;-378.348300000000,44.6480000000000;-378.059300000000,43.6793000000000;-377.487200000000,42.0357000000000;-376.916700000000,40.4763000000000;-376.629800000000,39.6130000000000;-376.342100000000,38.6367000000000;-376.065200000000,37.5364000000000;-375.815400000000,36.3150000000000;-375.609500000000,34.9755000000000;-375.463800000000,33.5209000000000;-375.395000000000,31.9540000000000;-375.418900000000,30.2788000000000;-375.696600000000,26.7795000000000;-375.882700000000,25.1056000000000;-376.054000000000,23.5842000000000;-376.175900000000,22.2916000000000;-376.213600000000,21.3044000000000];

d=[-336.112600000000,68.2983000000000;-336.938000000000,68.2699000000000;-337.757900000000,68.1711000000000;-338.566400000000,68.0026000000000;-339.357600000000,67.7656000000000;-340.125600000000,67.4619000000000;-340.864800000000,67.0936000000000;-341.166100000000,66.9199000000000;-341.116700000000,66.4442000000000;-341.031400000000,65.6225000000000;-340.946000000000,64.8008000000000;-340.860600000000,63.9791000000000;-340.775300000000,63.1574000000000;-340.752000000000,62.9333000000000;-341.352300000000,62.9592000000000;-342.177700000000,62.9947000000000;-343.003100000000,63.0301000000000;-343.828400000000,63.0656000000000;-344.653800000000,63.1011000000000;-344.756300000000,63.1055000000000;-345.066300000000,62.4520000000000;-345.359400000000,61.6799000000000;-345.585300000000,60.8855000000000;-345.742600000000,60.0747000000000;-345.830000000000,59.2535000000000;-345.846900000000,58.4278000000000;-345.793200000000,57.6037000000000;-345.669300000000,56.7872000000000;-345.476000000000,55.9842000000000;-345.214900000000,55.2007000000000;-344.887700000000,54.4424000000000;-344.496900000000,53.7149000000000;-344.045400000000,53.0233000000000;-343.536400000000,52.3729000000000;-342.973700000000,51.7684000000000;-342.361500000000,51.2142000000000;-341.704000000000,50.7143000000000;-341.006300000000,50.2724000000000;-340.273400000000,49.8918000000000;-339.510600000000,49.5752000000000;-338.723600000000,49.3249000000000;-337.918000000000,49.1428000000000;-337.099900000000,49.0302000000000;-336.275100000000,48.9880000000000];
e=[-330.759800000000,14.4771000000000;-327.459400000000,15.3770000000000;-324.281600000000,16.6434000000000;-321.266900000000,18.2603000000000;-318.453900000000,20.2070000000000;-315.878400000000,22.4585000000000;-313.573300000000,24.9862000000000;-311.568100000000,27.7578000000000;-310.595200000000,29.3867000000000;-311.973000000000,30.0362000000000;-314.547000000000,32.2614000000000;-316.121600000000,35.2777000000000;-316.475800000000,38.6617000000000;-315.559900000000,41.9386000000000;-313.502400000000,44.6486000000000;-310.592100000000,46.4114000000000;-307.237400000000,46.9795000000000;-306.921900000000,46.9675000000000;-307.375200000000,50.0400000000000;-308.235800000000,53.3508000000000;-309.464500000000,56.5435000000000;-311.045400000000,59.5772000000000;-312.958500000000,62.4131000000000;-315.179300000000,65.0152000000000;-317.679400000000,67.3501000000000;-320.427000000000,69.3881000000000;-323.386900000000,71.1031000000000;-326.521400000000,72.4733000000000;-329.790500000000,73.4812000000000;-333.152400000000,74.1138000000000;-336.564200000000,74.3631000000000;-339.982400000000,74.2260000000000;-343.363200000000,73.7041000000000];
f=[-338.633600000000,40.3417000000000;-339.334800000000,40.3400000000000;-340.017300000000,40.5011000000000;-340.643700000000,40.8163000000000;-341.179800000000,41.2682000000000;-341.596400000000,41.8323000000000;-341.870600000000,42.4776000000000;-341.896800000000,42.5728000000000;-342.445200000000,42.3195000000000;-343.062500000000,41.9839000000000;-343.654700000000,41.6058000000000;-344.219000000000,41.1870000000000;-344.752400000000,40.7297000000000;-345.252400000000,40.2360000000000;-345.459200000000,40.0100000000000;-345.141800000000,39.7729000000000;-344.665800000000,39.2580000000000;-344.322400000000,38.6467000000000;-344.130300000000,37.9723000000000;-344.099900000000,37.2718000000000;-344.233000000000,36.5833000000000;-344.522300000000,35.9446000000000;-344.951900000000,35.3904000000000;-345.498500000000,34.9511000000000;-346.132100000000,34.6507000000000;-346.818100000000,34.5056000000000;-347.519100000000,34.5237000000000;-347.904200000000,34.6052000000000;-347.937600000000,34.2982000000000;-347.978100000000,33.5967000000000;-347.969200000000,32.8941000000000;-347.911100000000,32.1939000000000;-347.803800000000,31.4994000000000;-347.648100000000,30.8142000000000;-347.444700000000,30.1417000000000;-347.194500000000,29.4851000000000;-346.898900000000,28.8476000000000;-346.559200000000,28.2325000000000;-346.177100000000,27.6428000000000;-345.754600000000,27.0814000000000;-345.293700000000,26.5510000000000;-344.796700000000,26.0543000000000;-344.266000000000,25.5937000000000;-343.704300000000,25.1715000000000;-343.114400000000,24.7898000000000;-342.499100000000,24.4505000000000;-341.861500000000,24.1552000000000;-341.204700000000,23.9055000000000;-340.532000000000,23.7024000000000;-339.846700000000,23.5471000000000;-339.152200000000,23.4403000000000;-338.451900000000,23.3826000000000;-337.749300000000,23.3741000000000;-337.047800000000,23.4151000000000];

g=[-342.289700000000,96.8289000000000;-345.009300000000,98.3629000000000;-342.536900000000,99.5506000000000;-344.910400000000,100.936200000000;-342.536900000000,102.371200000000;-344.910400000000,103.558900000000;-342.339100000000,105.092900000000;-344.910400000000,106.775400000000;-342.487500000000,108.210500000000;-345.207000000000,109.744500000000;-342.734700000000,110.932200000000;-345.108200000000,112.317800000000];
h=[-348.389500000000,68.5238000000000;-355.026100000000,68.5238000000000;-355.026100000000,75.1604000000000;-348.389500000000,75.1604000000000;-348.389500000000,81.7969000000000;-355.026100000000,81.7969000000000;-355.026100000000,88.4335000000000;-348.389500000000,88.4335000000000;-348.389500000000,95.0700000000000;-355.026100000000,95.0700000000000;-355.026100000000,101.706600000000;-348.389500000000,101.706600000000;-348.389500000000,108.343100000000;-355.026100000000,108.343100000000];
i=[-396.776000000000,126.076400000000;-395.998500000000,123.172000000000;-393.818100000000,121.101900000000;-390.877300000000,120.476100000000;-388.042900000000,121.479100000000;-386.150200000000,123.815300000000;-385.700500000000,125.928900000000;-385.620800000000,126.794300000000;-384.325800000000,129.507700000000;-381.803800000000,131.144700000000;-378.798200000000,131.222700000000;-376.194800000000,129.718800000000;-374.760700000000,127.076200000000;-374.624900000000,125.781400000000;-374.376700000000,124.066500000000;-372.739700000000,121.544600000000;-370.026300000000,120.249600000000;-367.036100000000,120.563200000000;-364.650300000000,122.393000000000;-363.572200000000,125.199700000000;-363.549400000000,125.633900000000;-362.912300000000,128.140000000000;-360.842200000000,130.320400000000;-357.937900000000,131.097900000000;-355.055200000000,130.243400000000;-353.043900000000,128.008600000000;-352.473800000000,125.486400000000;-352.462500000000,125.051700000000;-351.459500000000,122.217300000000;-349.123400000000,120.324700000000;-346.142600000000,119.931500000000;-343.395600000000,121.153800000000;-341.692100000000,123.631300000000;-341.398300000000,125.338900000000;-341.228000000000,126.629700000000;-339.724100000000,129.233100000000;-337.081500000000,130.667200000000;-334.079100000000,130.509100000000;-331.601600000000,128.805600000000;-330.379300000000,126.058700000000;-330.322700000000,125.191400000000;-329.929400000000,123.066600000000;-328.099600000000,120.680900000000;-325.292900000000,119.602800000000;-322.336500000000,120.150000000000;-320.101700000000,122.161300000000;-319.247100000000,125.044000000000];

puntosT={a b c d e f g h i};
%%
maxS=41;
%% NORMALIZAR SEG
 vec=puntosT; 
for u=1:1:length(puntosT)
   vec{:,u}=optimazeCurve(maxS,puntosT{:,u}); %
end
%% 
%% OUR METHOD DISSIMILARITY
alpha=0.30;
J=dissimilarityF(vec,alpha,maxS,8);

%% DISSIMILARITY FRETCHET
         matF=[];
            for u=1:1:length(vec)
                value=[];
               for h=1:1:length(vec)                  
                   [cm, cSq] = DiscreteFrechetDist(vec{:,u},vec{:,h});
                   value=[value cm];
               end
                matF=[matF; value];
            end
%%%%%%%%%%%%%%%%%%%%%%%%%
figure(1)
h = heatmap(J);
h.Colormap = hot(64);
XLabels = {'a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i'};
CustomXLabels = string(XLabels);
h.XDisplayLabels = CustomXLabels;
YLabels = {'a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i'};
CustomYLabels = string(YLabels);
h.YDisplayLabels = CustomYLabels;
fig = gcf;    %or one particular figure whose handle you already know, or 0 to affect all figures
set( findall(fig, '-property', 'fontsize'), 'fontsize', 24)
grid off
title('Our Method')
% Ax = gca;
% Ax.XDisplayLabels = nan(size(Ax.XDisplayData));
% Ax.YDisplayLabels = nan(size(Ax.YDisplayData));


MaxV=max(max(matF));
matF=matF/MaxV;
figure(2)
h = heatmap(matF);
h.Colormap = hot(64);
XLabels = {'a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i'};
CustomXLabels = string(XLabels);
h.XDisplayLabels = CustomXLabels;
YLabels = {'a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i'};
CustomYLabels = string(YLabels);
h.YDisplayLabels = CustomYLabels;
fig = gcf;    %or one particular figure whose handle you already know, or 0 to affect all figures
set( findall(fig, '-property', 'fontsize'), 'fontsize', 24)
grid off
title('Frechet distance ')


figure(3)
for i=1:1:9
 h1=plot(i,J(i,1),'bo',i,J(i,2),'m+',i,J(i,3),'c*',i,J(i,4),'r<',i,J(i,5),'gx',i,J(i,6),'b^',i,J(i,7),'mv',i,J(i,8),'ks',i,J(i,9),'bd');
 hold on
 xticks([1 2 3 4 5 6 7 8 9])
xticklabels({'a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i'})
end
legend('a', 'b' ,'c' ,'d' ,'e', 'f', 'g', 'h', 'i')
fig = gcf;    %or one particular figure whose handle you already know, or 0 to affect all figures
set( findall(fig, '-property', 'fontsize'), 'fontsize', 18)
grid off





% Ax = gca;
% Ax.XDisplayLabels = nan(size(Ax.XDisplayData));
% Ax.YDisplayLabels = nan(size(Ax.YDisplayData));


% s = struct(h);
% s.XAxis.TickLabelRotation = 360;
% id1 = strsplit(string(IDSC{:,1}),'0');
% id2 = strsplit(string(IDSC{:,21}),'0');
% cdl = h.XDisplayLabels;
% XLabels=['','','','','','','','','',string(id1(:,1)) ,'','','','','','','','','','','','','','','','','','','',string(id2(:,1)),'','','','','','','','','',''];
% h.XDisplayLabels = XLabels;
% YLabels=['','','','','','','','','',string(id1(:,1)) ,'','','','','','','','','','','','','','','','','','','',string(id2(:,1)),'','','','','','','','','',''];
% h.YDisplayLabels = YLabels;
% h.Title = 'Dissimilarity';
% h.XLabel = 'Dissimilarity Values';
% h.YLabel = strcat('Alpha=',string(alpha));
% 
% %% PLOT FOR UMBRALL
% figure(2)
% h1=plot(J(1:20,1:20), 'b+');
% hold on
% h2=plot(J(1:20,21:40), 'r*');
% legend([h1(1),h2(1)],id1(:,1),id2(:,1))
% xlabel('Closes curves') 
% ylabel('Dissimilarity values') 
% 
% figure(3)
% v=heatmap(matF);
% s = struct(v);
% s.XAxis.TickLabelRotation = 360;
% id1 = strsplit(string(IDSC{:,1}),'1');
% id2 = strsplit(string(IDSC{:,21}),'1');
% cdl = v.XDisplayLabels;
% XLabels=['','','','','','','','','',string(id1(:,1)) ,'','','','','','','','','','','','','','','','','','','',string(id2(:,1)),'','','','','','','','','',''];
% v.XDisplayLabels = XLabels;
% YLabels=['','','','','','','','','',string(id1(:,1)) ,'','','','','','','','','','','','','','','','','','','',string(id2(:,1)),'','','','','','','','','',''];
% v.YDisplayLabels = YLabels;
% v.Title = 'Dissimilarity Frechet';
% v.XLabel = 'Dissimilarity Values';
% v.YLabel = strcat('Alpha=',string(alpha));
% 
% figure(4)
% h3=plot(matF(1:20,1:20), 'b+');
% hold on
% h4=plot(J(1:20,21:40), 'r*');
% legend([h3(1),h4(1)],id1(:,1),id2(:,1))
% xlabel('Open curves') 
% ylabel('Dissimilarity values') 
